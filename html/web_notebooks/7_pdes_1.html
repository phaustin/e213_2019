

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Learning goals &#8212; Numeric course 0.1 documentation</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link href="../_static/css/index.css" rel="stylesheet">
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">

<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>

<div id="navbar-menu" class="collapse navbar-collapse">
  <ul id="navbar-main-elements" class="navbar-nav mr-auto">
    <li class="nav-item">
        <a class="nav-link" href="../index.html">Home</a>
    </li>
    
    
    <li class="nav-item ">
        <a class="nav-link" href="../learning_goals/learning_goals.html">Learning goals</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../week_notes.html">Weekly notes</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../solutions.html">Assignment solutions</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../texts.html">Texts</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../getting_started.html">Python</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../cheat_sheet.html">Cheat sheet</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../notebook_index.html">Notebook index</a>
    </li>
    
    
  </ul>
  <ul class="navbar-nav ml-auto">
    
    
  </ul>
</div>
    </nav>
    

    <div class="container-fluid">
      <div class="row">
          
          <div class="col-12 col-md-3 col-xl-2 bd-sidebar">

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>

</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>
              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5.5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<h1><p>Table of Contents</p>
</h1><div class="toc"><ul class="toc-item"><li><p>1  Learning goals</p>
</li><li><p>2  Approach to develop a partial differential equation</p>
<ul class="toc-item"><li><p>2.1  2-d transient mass - balance statement</p>
</li><li><p>2.2  Sign conventions</p>
</li><li><p>2.3  Upshot</p>
</li><li><p>2.4  Per unit volume, per unit time</p>
</li><li><p>2.5  Your turn</p>
</li><li><p>2.6  Partial differential equation</p>
</li></ul></li><li><p>3  Conservation of mass equation in 3 dimensions</p>
<ul class="toc-item"><li><p>3.1  Interpretation</p>
</li><li><p>3.2  Your turn</p>
</li><li><p>3.3  Divergence of a vector</p>
</li><li><p>3.4  Your turn</p>
</li></ul></li><li><p>4  Vector notation</p>
<ul class="toc-item"><li><p>4.1  Why <span class="math notranslate nohighlight">\(\vec{\nabla}\)</span>?</p>
</li></ul></li><li><p>5  Diffusion equation</p>
<ul class="toc-item"><li><p>5.1  Your turn</p>
</li><li><p>5.2  Constant diffusion coefficient</p>
</li><li><p>5.3  Diffusion in porous media</p>
</li><li><p>5.4  For homogeneous porosity</p>
</li></ul></li><li><p>6  Solving PDEs: Boundary - value problems</p>
<ul class="toc-item"><li><p>6.1  Boundary-value problem checklist</p>
</li><li><p>6.2  TMF BVP example</p>
</li><li><p>6.3  Equation</p>
</li><li><p>6.4  Domain</p>
</li><li><p>6.5  Properties of the problem domain</p>
</li><li><p>6.6  Boundary conditions</p>
</li><li><p>6.7  Initial conditions</p>
</li></ul></li><li><p>7  Assignment</p>
</li><li><p>8  1 Finding an analytical solution</p>
<ul class="toc-item"><li><p>8.1  Your turn</p>
</li></ul></li><li><p>9  2 Interpretation</p>
<ul class="toc-item"><li><p>9.1  1.</p>
</li><li><p>9.2  2.</p>
</li><li><p>9.3  3.</p>
</li><li><p>9.4  4.</p>
</li></ul></li></ul></div><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</div>
<div class="section" id="Learning-goals">
<h1>Learning goals<a class="headerlink" href="#Learning-goals" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><p>Be able to take a discrete approximation to limit of infinitesimal volume size and time step to arrive at the partial differential equation.</p></li>
<li><p>Be able to read a partial differential equation:</p></li>
</ol>
<ul class="simple">
<li><p>distinguish between terms that represent fluxes, sources and storage of quantities within the volume (infinitesimal point).</p></li>
<li><p>recognize the order of the equation.</p></li>
<li><p>recognize conservative forms</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Be able to simplify a partial differential equation when coefficients are constant.</p></li>
<li><p>Recognize the conservation principle in integral form and match it to the corresponding partial differential equation.</p></li>
<li><p>Be able to set up boundary value problem:</p></li>
</ol>
<ul class="simple">
<li><p>define domain of the problem.</p></li>
<li><p>define the equations that govern the dependent variable.</p></li>
<li><p>define the parameters of the equation, and if they are spatially homogeneous (do not vary in space) or heterogeneous.</p></li>
<li><p>distinguish between the principal boundary conditions that prevail.</p></li>
<li><p>assign initial conditions (if a time dependent problem).</p></li>
</ul>
<ol class="arabic simple" start="6">
<li><p>Be able to understand the significance of the mathematical concept of divergence and its relationship to flux at a point.</p></li>
<li><p>Be able to recognize a partial differential equation when written in vector form using divergence and gradient.</p></li>
</ol>
</div>
<div class="section" id="Approach-to-develop-a-partial-differential-equation">
<h1>Approach to develop a partial differential equation<a class="headerlink" href="#Approach-to-develop-a-partial-differential-equation" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><p>Write a discrete approximation for mass conservation for a finite volume.</p></li>
<li><p>Take limits as the size of the volume element and the time period of consideration shrink to infinitesimal size.</p></li>
<li><p>Recognize limits as derivatives. Where the independent variable (eg concentration) is a function of more than one dependent variable (typically 3 space dimensions <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span>, and <span class="math notranslate nohighlight">\(t\)</span>), the derivatives are partial.</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;figures/shrink_to_infinitesimal.png&quot;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;35%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../_images/web_notebooks_7_pdes_1_4_0.png"><img alt="../_images/web_notebooks_7_pdes_1_4_0.png" src="../_images/web_notebooks_7_pdes_1_4_0.png" style="width: 35%;" /></a>
</div>
</div>
<div class="section" id="2-d-transient-mass---balance-statement">
<h2>2-d transient mass - balance statement<a class="headerlink" href="#2-d-transient-mass---balance-statement" title="Permalink to this headline">¶</a></h2>
<p>We’ll do this in 2-d. From that we can easily go to either 3-d or 1-d.</p>
<p>We’ll consider the transient case, where mass is changing in time in the volume. Let’s consider the simple 2-d stencil, where the gridblock is of size <span class="math notranslate nohighlight">\(\Delta x\)</span>, <span class="math notranslate nohighlight">\(\Delta y\)</span>, <span class="math notranslate nohighlight">\(\Delta z\)</span> (where <span class="math notranslate nohighlight">\(\Delta z\)</span> is into the page in the figure below).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;figures/nsewc_stencil.png&quot;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;20%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../_images/web_notebooks_7_pdes_1_6_0.png"><img alt="../_images/web_notebooks_7_pdes_1_6_0.png" src="../_images/web_notebooks_7_pdes_1_6_0.png" style="width: 20%;" /></a>
</div>
</div>
<p>Recall from notebook <code class="docutils literal notranslate"><span class="pre">5.1_finite_volume_2.ipynb</span></code> A transient conservation statement is * <strong>the change of the quanity in the volume over a time :math:`Delta t` = the net flux of the quantity into the volume over the time period :math:`Delta t`</strong>.</p>
<p>To make things more concrete, let’s consider the case where the conserved quantity is mass <span class="math notranslate nohighlight">\(m\)</span>, such as sulfate.</p>
<p>In one dimension, the transient conservation expression is (from <code class="docutils literal notranslate"><span class="pre">5.1_finite_volume_2.ipynb</span></code>):</p>
<p><span class="math">\begin{align}
\Delta m_C = m_C(t+\Delta t) - m_C(t) & = (J_E+J_W)\Delta t \label{1dcons}\\
\end{align}</span></p>
<p>where both sides of the equation have dimensions of mass: * <span class="math notranslate nohighlight">\(m_C(t)~\left[M\right]\)</span> is the mass in gridblock C at time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(m_C(t+\Delta t)~\left[M\right]\)</span> is the mass in gridblock C at time <span class="math notranslate nohighlight">\(t+\Delta t\)</span> * <span class="math notranslate nohighlight">\((J_E+J_W)\Delta t~\left[M\right]\)</span> is the net mass that fluxed into volume over time period <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>If we now go to 2-d and express this equation in terms of specific fluxes <span class="math notranslate nohighlight">\({j}\)</span>, and recall that <span class="math notranslate nohighlight">\({J}=jA\)</span> where we multiply the net specific flux by the area of the boundary of volume perpendicular to the flux component (<em>eg</em> for fluxes in the <span class="math notranslate nohighlight">\(x\)</span> direction, the area perpendicular is <span class="math notranslate nohighlight">\(\Delta y \Delta z\)</span>): <span class="math">\begin{align}
\left(m_C(t+\Delta t) - m_C(t)\right) = \left\{\left(j_{EC} + j_{WC}\right) \Delta y \Delta z +  \left(j_{NC} + j_{SC}\right) \Delta x \Delta z \right\}\Delta t \label{7pde1}\\
\end{align}</span></p>
</div>
<div class="section" id="Sign-conventions">
<h2>Sign conventions<a class="headerlink" href="#Sign-conventions" title="Permalink to this headline">¶</a></h2>
<p>The next step is to re-express the fluxes in the discrete approximation such as <span class="math notranslate nohighlight">\(j_{EC}\)</span> in terms of components of a flux vector that varies continuously with location (here in 2-d) <span class="math notranslate nohighlight">\(\vec{j}= \left\{j_x, j_y\right\}\)</span> - the “true” flux that is approximated at gridblock edges by <span class="math notranslate nohighlight">\(j_{EC}\)</span>, etc. The only “trick” here is to be careful of the sign conventions.</p>
<p>In contrast to our finite volume convention where fluxes such as <span class="math notranslate nohighlight">\(j_{EC}\)</span> are <strong>positive</strong> for flux <strong>into the volume</strong>, in math, a vector component is <strong>positive</strong> if the vector is pointing in the direction in which the <strong>coordinate direction corresponding to that component is increasing</strong>.</p>
<p>We’ll demonstrate this for the <span class="math notranslate nohighlight">\(x\)</span> direction here. Consider gridblock C where the left (W) face is located at <span class="math notranslate nohighlight">\(x\)</span> and the right (E) face is located a position <span class="math notranslate nohighlight">\(x+\Delta x\)</span>. First, recognize that both <span class="math notranslate nohighlight">\(j_{WC}\)</span> and <span class="math notranslate nohighlight">\(j_{EC}\)</span> are <span class="math notranslate nohighlight">\(x\)</span> flux components.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;figures/cv_x_dx.png&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;25%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../_images/web_notebooks_7_pdes_1_10_0.png"><img alt="../_images/web_notebooks_7_pdes_1_10_0.png" src="../_images/web_notebooks_7_pdes_1_10_0.png" style="width: 25%;" /></a>
</div>
</div>
<p>Here is the correspondence:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(j_{WC}\)</span> corresponds to <span class="math notranslate nohighlight">\(j_x(x,y,z)\)</span> because when <span class="math notranslate nohighlight">\(j_x\)</span> is positive, flux enters C, just like <span class="math notranslate nohighlight">\(j_{WC}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(j_{EC}\)</span> corresponds to <span class="math notranslate nohighlight">\(-j_x(x+\Delta x,y,z)\)</span> because when <span class="math notranslate nohighlight">\(-j_x\)</span> is positive flux enters C, just like <span class="math notranslate nohighlight">\(j_{EC}\)</span></p></li>
</ul>
<p>Example, for some hypothetical situation, <span class="math notranslate nohighlight">\(j_x(x,y,z) = 3~mg/(s\cdot m^2)\)</span> and <span class="math notranslate nohighlight">\(j_x(x+\Delta x,y,z) = -2.5~mg/(s\cdot m^2)\)</span>, then * on the W face, <span class="math notranslate nohighlight">\(j_x\)</span> is directed in the positive <span class="math notranslate nohighlight">\(x\)</span> direction, so is flowing into C, so <span class="math notranslate nohighlight">\(j_{WC} = j_x(x,y,z) = 3~ mg/(s\cdot m^2)\)</span> * on the E face, <span class="math notranslate nohighlight">\(j_x\)</span> is directed in the negative <span class="math notranslate nohighlight">\(x\)</span> direction, so is flowing into C, so <span class="math notranslate nohighlight">\(j_{EC} = -j_x(x+\Delta x,y,z) = 2.5 ~mg/(s\cdot m^2)\)</span></p>
</div>
<div class="section" id="Upshot">
<h2>Upshot<a class="headerlink" href="#Upshot" title="Permalink to this headline">¶</a></h2>
<p>In our conservation statement <span class="math">\ref{7pde1}</span>, we replace <span class="math notranslate nohighlight">\(j_{WC}\rightarrow j_x(x,y,z)\)</span> and <span class="math notranslate nohighlight">\(j_{EC} \rightarrow -j_x(x+\Delta x,y,z)\)</span>. Similarly, in the <span class="math notranslate nohighlight">\(y\)</span> direction <span class="math notranslate nohighlight">\(j_{SC}\rightarrow j_y(x,y,z)\)</span> and <span class="math notranslate nohighlight">\(j_{NC} \rightarrow -j_y(x,y+\Delta y,z)\)</span> The conservation statement <span class="math">\ref{7pde1}</span> becomes:</p>
<p><span class="math">\begin{align}
m_C(t+\Delta t) - m_C(t) = \left\{\left(-j_x(x+\Delta x,y,z)+j_x(x,y,z) \right) \Delta y \Delta z +  \left(-j_y(x,y+\Delta y,z) + j_y(x,y,z)\right) \Delta x \Delta z \right\}\Delta t \label{7pde2}\\
\end{align}</span></p>
</div>
<div class="section" id="Per-unit-volume,-per-unit-time">
<h2>Per unit volume, per unit time<a class="headerlink" href="#Per-unit-volume,-per-unit-time" title="Permalink to this headline">¶</a></h2>
<p>Next, divide the equation by the volume of the control volume (gridblock), <span class="math notranslate nohighlight">\((\Delta x)(\Delta y) (\Delta z)\)</span> and time interval <span class="math notranslate nohighlight">\((\Delta t)\)</span>: <span class="math">\begin{align}
{m_C(t+\Delta t) - m_C(t)\over (\Delta t)(\Delta x)(\Delta y) (\Delta z)}
= {-j_x(x+\Delta x,y,z)+j_x(x,y,z) \over  \Delta x} +  {-j_y(x,y+\Delta y,z) + j_y(x,y,z)\over  \Delta y}  \label{7pde3}\\
\end{align}</span> Because concentration is mass over volume, in <span class="math">\ref{7pde3}</span> we can substitute concentration <span class="math notranslate nohighlight">\(c\)</span> for <span class="math notranslate nohighlight">\(m_C\)</span>, mass in the control volume C. If we substitute <span class="math notranslate nohighlight">\({m_C\over (\Delta x)(\Delta y) (\Delta z)}\rightarrow c\)</span>:</p>
<p><span class="math">\begin{align}
{ c(t+\Delta t) - c(t)\over \Delta t}
= { -j_x(x+\Delta x,y,z)+j_x(x,y,z)  \over  \Delta x} +  { -j_y(x,y+\Delta y,z) + j_y(x,y,z) \over  \Delta y}  \label{7pde4}\\
\end{align}</span></p>
</div>
<div class="section" id="Your-turn">
<h2>Your turn<a class="headerlink" href="#Your-turn" title="Permalink to this headline">¶</a></h2>
<p>Answer the following questions in this cell:</p>
<ol class="arabic simple">
<li><p>What are the dimensions of each term in the conservation equation above <span class="math">\ref{7pde4}</span>? <span class="math notranslate nohighlight">\(\left[ DIMENSIONS~HERE\right]\)</span></p></li>
<li><p>Does this term <span class="math notranslate nohighlight">\({ c(t+\Delta t) - c(t)\over \Delta t}\)</span> remind you of anything from calculus? What? <strong>type answer here</strong></p></li>
<li><p>Does this term <span class="math notranslate nohighlight">\({-j_y(x,y+\Delta y,z) + j_y(x,y,z)\over \Delta y}\)</span> remind you of anything from calculus? What? <strong>type answer here</strong></p></li>
</ol>
</div>
<div class="section" id="Partial-differential-equation">
<h2>Partial differential equation<a class="headerlink" href="#Partial-differential-equation" title="Permalink to this headline">¶</a></h2>
<p>The conservation equation <span class="math">\ref{7pde4}</span> is an algebraic equation that applies to a finite-sized control volume C. When we divided by volume and time, we re-expressed the expression on a per unit volume, per unit time basis. Next, we are going to take limits and shrink the volume and time to infinitesimals. In the process, the equation will transform from an algebraic equation to a differential equation. Up to now, we have been considering finite-sized volumes and fluxes in and out
over time periods, with a differential equation, we can think of fluxes in and out of mathematical points over instances in time.</p>
<p>Recognize <span class="math">\begin{align}
&\lim_{\Delta t, \Delta x,\Delta y,\Delta z \rightarrow 0} { c(t+\Delta t) - c(t)\over \Delta t} = {\partial c\over \partial t}\\
&\\
&\lim_{\Delta t, \Delta x,\Delta y,\Delta z \rightarrow 0}{-j_x(x+\Delta x,y,z)+j_x(x,y,z) \over  \Delta x}= -{\partial j_x\over \partial x}\\
&\\
&\lim_{\Delta t, \Delta x,\Delta y,\Delta z \rightarrow 0}{-j_y(x,y+\Delta y,z)+j_y(x,y,z) \over  \Delta y}= -{\partial j_y\over \partial y}\\
\end{align}</span></p>
<p>So the algebraic equation becomes the <strong>partial differential equation</strong> (pde) <span class="math">\begin{align}
{\partial c\over \partial t} &= -{\partial j_x\over \partial x}-{\partial j_y\over \partial y} \label{7pde5}\\
\end{align}</span> # Conservation of mass equation in 3 dimensions In three dimensions, (Cartesian coordinates): <span class="math">\begin{align}
{\partial c\over \partial t} &= -{\partial j_x\over \partial x}-{\partial j_y\over \partial y}-{\partial j_z\over \partial z}  \label{7pde6}\\
\end{align}</span> ## Interpretation You can interpret this pde just the way we interpreted our finite-volume conservation statements: <span class="math">\begin{align}
\overbrace{\partial c\over \partial t}^\text{rate of mass change at point} &= \underbrace{-{\partial j_x\over \partial x}-{\partial j_y\over \partial y}-{\partial j_z\over \partial z}}_\text{net flux rate into a point}  \label{7pde7}\\
\end{align}</span></p>
<p>The left side is the rate of change of mass per unit volume at a point, and the right hand side (the sum of the terms) is the net rate at which mass is fluxing into the point per unit volume.</p>
</div>
<div class="section" id="id1">
<h2>Your turn<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Answer the question in this cell. 1. What are the dimensions of each term in the pde <span class="math">\ref{7pde7}</span>? Do those dimensions agree with the description above?</p>
<p>The dimensions are <span class="math notranslate nohighlight">\(\left[\text{Replace with correct dimensions}\right]\)</span></p>
</div>
<div class="section" id="Divergence-of-a-vector">
<h2>Divergence of a vector<a class="headerlink" href="#Divergence-of-a-vector" title="Permalink to this headline">¶</a></h2>
<p>The <strong>divergence</strong> of a flux vector <span class="math notranslate nohighlight">\(\vec{j}=(j_x, j_y, j_z)\)</span> is a <strong>number</strong>, defined as <span class="math">\begin{align}
\text{divergence of }\vec{j} &= {{\partial j_x\over \partial x}+{\partial j_y\over \partial y}+{\partial j_z\over \partial z}}  \label{7pde8}\\
\end{align}</span> In pictures, the divergence is the rate per unit volume at which a flux is spreading <strong>out</strong> from a point. In the picture below, the lines indicate flux directions. On the left, flux is diverging from the point, so at that point it is <strong>positive</strong>. On the right, flux is converging to a point, so the divergence is <strong>negative</strong>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;figures/E.png&quot;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;50%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../_images/web_notebooks_7_pdes_1_16_0.png"><img alt="../_images/web_notebooks_7_pdes_1_16_0.png" src="../_images/web_notebooks_7_pdes_1_16_0.png" style="width: 50%;" /></a>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>Your turn<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Answer the question in this cell.</p>
<ol class="arabic simple">
<li><p>What does it mean if at a point, the divergence of the flux is zero <span class="math notranslate nohighlight">\({{\partial j_x\over \partial x}+{\partial j_y\over \partial y}+{\partial j_z\over \partial z}}=0\)</span>?</p></li>
</ol>
</div>
</div>
<div class="section" id="Vector-notation">
<h1>Vector notation<a class="headerlink" href="#Vector-notation" title="Permalink to this headline">¶</a></h1>
<p>The divergence is a concept from vector calculus and is found in most pdes that describe conservation laws. Accordingly it gets a special <em>nabla</em>, <span class="math notranslate nohighlight">\(\nabla\)</span>, notation (see <a class="reference external" href="https://en.wikipedia.org/wiki/Del">https://en.wikipedia.org/wiki/Del</a>): <span class="math">\begin{align}
\vec{\nabla} \cdot \vec{j} = \text{div}~\vec{j} = \text{divergence of }\vec{j} &= {{\partial j_x\over \partial x}+{\partial j_y\over \partial y}+{\partial j_z\over \partial z}}  \label{7pde9}\\
\end{align}</span> The nabla <span class="math notranslate nohighlight">\(\vec{\nabla}\)</span> is a vector - calculus operator: it takes action “operates” on an argument. In Cartesian coordinates, it is often written as a vector: <span class="math">\begin{align}
\vec{\nabla}  &= \left({{\partial  \over \partial x},{\partial  \over \partial y},{\partial  \over \partial z}}\right)  \label{7pde10}\\
\end{align}</span> <strong>Divergence of a flux</strong> : the nabla vector maps a flux vector to a scalar number, the divergence (the net flux rate per unit volume):</p>
<p><span class="math">\begin{align}
\vec{\nabla} \cdot \vec{j} =\left({{\partial  \over \partial x},{\partial  \over \partial y},{\partial  \over \partial z}}\right)  \cdot \left\{\begin{array}{c}
j_x\\
j_y\\
j_z\\
\end{array}\right\} = {{\partial j_x\over \partial x}+{\partial j_y\over \partial y}+{\partial j_z\over \partial z}}
\label{7pde11}
\end{align}</span> <strong>Gradient of a scalar</strong></p>
<p>A scalar is a single-valued function: at each point it has one value, unlike a flux which is a vector function - at each point it has 3 components (in a 3-d system). The gradient operator takes a scalar function and produces a vector that points in the direction in which the function is increasing. The nabla notation is used for the gradient (here for the case of concentration <span class="math notranslate nohighlight">\(c\)</span>): <span class="math">\begin{align}
\vec{\nabla} c &= \left({{\partial c \over \partial x},{\partial c \over \partial y},{\partial c \over \partial z}}\right)  \label{7pde12}\\
\end{align}</span></p>
<p>The latter is sometimes written as: <span class="math">\begin{equation}
\vec{\nabla} c = \overrightarrow{\text{grad}} c
\end{equation}</span> <strong>Fick’s law</strong></p>
<p>Fick’s law of diffusion says that the diffusive flux <span class="math notranslate nohighlight">\(\vec{j}\)</span> is a vector that points in the opposite direction of the concentration gradient. We can now write Fick’s law in vector-calculus nabla notation: <span class="math">\begin{align}
\vec{j} = -D \vec{\nabla} c &= \left({-D {\partial c \over \partial x},-D {\partial c \over \partial y},-D {\partial c \over \partial z}}\right)  \label{7pde13}\\
\end{align}</span> where <span class="math notranslate nohighlight">\(D~\left[L^2/T\right]\)</span> is the diffusion coefficient. That is, each component of the diffusive flux is: <span class="math">\begin{align}
j_x &= - D {\partial c \over \partial x}\\
j_y &= - D {\partial c\over \partial y}\\
j_z &= - D {\partial c\over \partial z}\\
\end{align}</span> ## Why <span class="math notranslate nohighlight">\(\vec{\nabla}\)</span>?</p>
<p>Why bother with the nabla notation? <strong>Clarity</strong>. Using the nabla notation, we clear up the clutter with partials here and there and make the connection to a conservation law very clear. Our conservation PDE becomes: <span class="math">\begin{align}
{\partial c\over \partial t} &= -{\partial j_x\over \partial x}-{\partial j_y\over \partial y}-{\partial j_z\over \partial z}  \quad\quad\rightarrow\quad\quad {\partial c\over \partial t}= -\vec{\nabla} \cdot \vec{j}  \label{7pde14}\\
\end{align}</span> In the righthand form of the equation, we can quickly see the divergence of a flux and “read” the equation quickly. If you see the divergence of a flux, then you are looking at a conservation statement.</p>
</div>
<div class="section" id="Diffusion-equation">
<h1>Diffusion equation<a class="headerlink" href="#Diffusion-equation" title="Permalink to this headline">¶</a></h1>
<p>We can now put this all together to get the diffusion equation. That is, we substitute components of Fick’s law <span class="math">\ref{7pde13}</span> into the conservation of mass equation <span class="math">\ref{7pde6}</span>: <span class="math">\begin{align}
&{\partial c\over \partial t} = {\partial \over \partial x}\left( D {\partial c \over \partial x}\right) + {\partial \over \partial y}\left( D {\partial c \over \partial y}\right)+ {\partial \over \partial z}\left( D {\partial c \over \partial z}\right)  \label{7pde15}\\
\text{or}&\nonumber\\
&{\partial c\over \partial t} = \vec{\nabla} \cdot (D \vec{\nabla} c)\label{7pde16}\\
\end{align}</span></p>
<p>which can also be written as <span class="math">\begin{equation}
\frac{\partial c}{\partial t} = \text{div} (D \overrightarrow{\text{grad}} c)
\end{equation}</span></p>
<p>These notations are used in everywhere the scientific literature, that’s why we are introducing them. But you should be able to make the link between them, and most importantly, relate to the mass-balance problem from which we have started them.</p>
<div class="section" id="id3">
<h2>Your turn<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Modify this transient 3-d diffusion equation into the steady-state 2-d (<span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> dimensions) equation: <span class="math">\begin{align}
&{\partial c\over \partial t} = {\partial \over \partial x}\left( D {\partial c \over \partial x}\right) + {\partial \over \partial y}\left( D {\partial c \over \partial y}\right)+ {\partial \over \partial z}\left( D {\partial c \over \partial z}\right)  \label{7pde17}\\
\end{align}</span></p>
</div>
<div class="section" id="Constant-diffusion-coefficient">
<h2>Constant diffusion coefficient<a class="headerlink" href="#Constant-diffusion-coefficient" title="Permalink to this headline">¶</a></h2>
<p>If the diffusion coefficient does not vary with position (is spatially homogeneous), we can simplify terms in the equation. For example by the chain rule: <span class="math">\begin{align}
{\partial \over \partial x}\left( D {\partial c \over \partial x}\right)=  {\partial D \over \partial x}{\partial c \over \partial x} + D{\partial^2 c \over \partial x^2}= 0 + D {\partial^2 c\over \partial x^2}  \label{7pde18}\\
\end{align}</span> since if <span class="math notranslate nohighlight">\(D\)</span> is homogeneous, it is not a function of <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, or <span class="math notranslate nohighlight">\(z\)</span> so <span class="math notranslate nohighlight">\({\partial D\over\partial x}= {\partial D\over\partial y}={\partial D\over\partial z}=0\)</span> and the equation becomes <span class="math">\begin{align}
&{\partial c\over \partial t} = D{\partial^2 c \over \partial x^2}+ D{\partial^2 c\over \partial y^2}+ D{\partial^2 c\over \partial z^2}  \label{7pde19}\\
\end{align}</span> This equation is sometimes written using nabla notation as:</p>
<p><span class="math">\begin{align}
&{\partial c\over \partial t} = D \nabla^2 c   \label{7pde20}\\
\end{align}</span></p>
</div>
<div class="section" id="Diffusion-in-porous-media">
<h2>Diffusion in porous media<a class="headerlink" href="#Diffusion-in-porous-media" title="Permalink to this headline">¶</a></h2>
<p>Earlier in <code class="docutils literal notranslate"><span class="pre">5.1_finite_volume_3.ipynb</span></code> we saw that Fick’s law of diffusion in porous media is (given here in vector notation): <span class="math">\begin{align}
\vec{j} = -D\theta\vec{\nabla} c c \label{7pde21}\\
\end{align}</span> where <span class="math notranslate nohighlight">\(\theta\)</span> is the porosity. To develop the PDE for diffusion in porous media, we have to change the storage term. If the entire control volume is filled with water, then for a dissolved solute like sulfate, the mass of sulfate is the concentration <span class="math notranslate nohighlight">\(\times\)</span> volume of the control volume: <span class="math">\begin{align}
m_C =c (\Delta x)(\Delta y)(\Delta z) \\
\end{align}</span> However, in porous media, when the pores are fully saturated with water, the volume of water in the gridblock is porosity <span class="math notranslate nohighlight">\(\times\)</span> total volume: <span class="math notranslate nohighlight">\(\theta (\Delta x)(\Delta y)(\Delta z)\)</span>, so the mass of solute in the water in the gridblock is the volume of water <span class="math notranslate nohighlight">\(\times\)</span> the concentration in the water: <span class="math notranslate nohighlight">\(c \theta (\Delta x)(\Delta y)(\Delta z)\)</span>. Upshot: In our derivation above, wherever we have <span class="math notranslate nohighlight">\(m_C\)</span> we substitute
<span class="math notranslate nohighlight">\(c\theta (\Delta x)(\Delta y)(\Delta z)\)</span> the result is in our PDE we make this change: <span class="math">\begin{align}
&{\partial c\over \partial t} \rightarrow  {\partial \theta c\over \partial t}  \label{7pde201}\\
\end{align}</span> And the equation for diffusion in porous media becomes: <span class="math">\begin{align}
&{\partial \theta c\over \partial t} = {\partial \over \partial x}\left( D\theta {\partial c \over \partial x}\right) + {\partial \over \partial y}\left( D\theta  {\partial c \over \partial y}\right)+ {\partial \over \partial z}\left( D \theta {\partial c \over \partial z}\right)  \label{7pde22}\\
\text{or}&\nonumber\\
&{\partial \theta c\over \partial t} = \nabla \cdot (D \theta \nabla c)\label{7pde23}\\
\end{align}</span> ## For homogeneous porosity If porosity is spatially homogeneous, much as above when the diffusion coefficient was homogeneous (constant in space and time) it is not a function of the independent variables <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span> and <span class="math notranslate nohighlight">\(t\)</span> so we can pull it out of the derivatives:<span class="math notranslate nohighlight">\({\partial \theta c\over \partial t}\rightarrow \theta{\partial c\over \partial t}\)</span> and
<span class="math notranslate nohighlight">\({\partial \over \partial x}\left( D\theta {\partial c \over \partial x}\right)\rightarrow \theta {\partial \over \partial x}\left( D {\partial c \over \partial x}\right)\)</span> and divide through both sides to get <span class="math">\begin{align}
&{\partial c\over \partial t} = {\partial \over \partial x}\left( D {\partial c \over \partial x}\right) + {\partial \over \partial y}\left( D {\partial c \over \partial y}\right)+ {\partial \over \partial z}\left( D {\partial c \over \partial z}\right)  \label{7pde24}\\
\end{align}</span> Surprise! For the case of homogeneous porosity, the equation is the same! However, if you are calculating fluxes between gridblocks, you have to use Fick’s law for porous media, <span class="math notranslate nohighlight">\(\vec{j} = -D\theta \nabla c\)</span>.</p>
</div>
</div>
<div class="section" id="Solving-PDEs:-Boundary---value-problems">
<h1>Solving PDEs: Boundary - value problems<a class="headerlink" href="#Solving-PDEs:-Boundary---value-problems" title="Permalink to this headline">¶</a></h1>
<p>The solution to a partial differential equation is a function in space (and time if transient) in a specified domain. Most courses on differential equations focus on methods to determine analytical (sometimes called closed-form) solutions, whereas in this course we focus on discrete approximations. Solving a partial differential equation requires that we establish a so-called boundary-value problem. This is a common-sense collection of information required before we solve the problem.</p>
<div class="section" id="Boundary-value-problem-checklist">
<h2>Boundary-value problem checklist<a class="headerlink" href="#Boundary-value-problem-checklist" title="Permalink to this headline">¶</a></h2>
<p>To solve a boundary value problem requires: 1. knowledge of the equation(s) that govern the dependent variable(s). 2. specification of the problem domain. 3. specification of properties of the problem domain. 4. specification of the value of the dependent variable or its derivatives everywhere on the boundary. 5. for time-dependent problems: ** initial conditions** - specification of the value of the dependent variables at the beginning of period of analysis.</p>
</div>
<div class="section" id="TMF-BVP-example">
<h2>TMF BVP example<a class="headerlink" href="#TMF-BVP-example" title="Permalink to this headline">¶</a></h2>
<p>We were asked to compute the steady-state concentration profile beneath the pond where the concentration at 2 m depth was fixed at <span class="math notranslate nohighlight">\(c=2000~mg/L\)</span> and at the pond-sediment interface <span class="math notranslate nohighlight">\(c=93~mg/L\)</span>. The sulfate moved by diffusion only, and there were no sources or sinks. Let’s go through the check list.</p>
</div>
<div class="section" id="Equation">
<h2>Equation<a class="headerlink" href="#Equation" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>This is a diffusion problem. We argued that because we were looking at a vertical profile in the middle of a large pond, the concentration only varies in one dimension (the vertical). Let’s say <span class="math notranslate nohighlight">\(z\)</span> is the vertical direction. Because the problems is steady, we know <span class="math notranslate nohighlight">\({\partial c\over\partial t} = 0\)</span>. So the equation for steady-state one-dimensional diffusion is: :nbsphinx-math:<a href="#id4"><span class="problematic" id="id5">`</span></a>begin{align}</dt><dd><p>{partial over partial z}left( D {partial c over partial z}right) =0 label{7pde25}\</p>
</dd>
</dl>
<p>end{align}`</p>
<dl class="simple">
<dt>Note that <span class="math notranslate nohighlight">\(c\)</span> varies with <span class="math notranslate nohighlight">\(z\)</span> only - it is one-dimensional and since it is steady, it does not vary with time. Therefore since in this case concentration is a function of one variable alone, we don’t need partials and can also write :nbsphinx-math:<a href="#id6"><span class="problematic" id="id7">`</span></a>begin{align}</dt><dd><p>{dover d z}left( D {d c over d z}right) =0 label{7pde26}\</p>
</dd>
<dt>end{align}` Because the diffusion coefficient is spatially homogeneous, we can pull it out of the derivative (as above): :nbsphinx-math:<a href="#id8"><span class="problematic" id="id9">`</span></a>begin{align}</dt><dd><p>D{d^2 c over d z^2} =0 label{7pde27}\</p>
</dd>
<dt>end{align}` Finally dividing both sides by the diffusion coefficient <span class="math notranslate nohighlight">\(D\)</span> we have: :nbsphinx-math:<a href="#id10"><span class="problematic" id="id11">`</span></a>begin{align}</dt><dd><p>{d^2 c over d z^2} =0 label{7pde28}\</p>
</dd>
</dl>
<p>end{align}`</p>
</div>
<div class="section" id="Domain">
<h2>Domain<a class="headerlink" href="#Domain" title="Permalink to this headline">¶</a></h2>
<p>The figure below shows the domain: the 1-D vertical profile under the middle of the pond:</p>
<p>Let’s put the origin <span class="math notranslate nohighlight">\(z=0\)</span> at 2 m depth, so that the pond-sediment interface is at <span class="math notranslate nohighlight">\(z=2~m\)</span>. We could also put the origin at the top and set <span class="math notranslate nohighlight">\(z=2~m\)</span> at 2 m into the sediments.</p>
</div>
<div class="section" id="Properties-of-the-problem-domain">
<h2>Properties of the problem domain<a class="headerlink" href="#Properties-of-the-problem-domain" title="Permalink to this headline">¶</a></h2>
<p>Here the only property needed to describe steady-state concentration profile is the diffusion coefficient <span class="math notranslate nohighlight">\(D\)</span>. For our problem, it’s value was spatially homogeneous <span class="math notranslate nohighlight">\(D=2\times 10^{-10}~m^2/s\)</span>.</p>
</div>
<div class="section" id="Boundary-conditions">
<h2>Boundary conditions<a class="headerlink" href="#Boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>This problem has two prescribed concentration boundary conditions. 1. <span class="math notranslate nohighlight">\(c(0)=2000~mg/L\)</span> at 2 m depth in the sediments (where <span class="math notranslate nohighlight">\(z=0\)</span>). 2. <span class="math notranslate nohighlight">\(c(2)=93~mg/L\)</span> at the pond-sediment interface (where <span class="math notranslate nohighlight">\(z=2~m\)</span>).</p>
</div>
<div class="section" id="Initial-conditions">
<h2>Initial conditions<a class="headerlink" href="#Initial-conditions" title="Permalink to this headline">¶</a></h2>
<p>Not required since this is not a time-dependent problem.</p>
</div>
</div>
<div class="section" id="Assignment">
<h1>Assignment<a class="headerlink" href="#Assignment" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="1-Finding-an-analytical-solution">
<h1>1 Finding an analytical solution<a class="headerlink" href="#1-Finding-an-analytical-solution" title="Permalink to this headline">¶</a></h1>
<p>Let’s see if we can guess the exact solution to the BVP for the TMF diffusion problem. ## Your turn</p>
<ol class="arabic simple">
<li><p>You are clever, and guess that the concentration profile varies linearly with depth. That is, the function is of the form</p></li>
</ol>
<p><span class="math">\begin{align}
c(z) &= az + b\\
\end{align}</span> where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are some coefficients. What are the values of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> that satisfy the boundary - value problem? Common sense: the solution has to run linearly between the two boundary points. Solve for <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> and enter their values in the cell below for autograding, i.e. write two lines of python that set:</p>
<p>a= xxx b=xxx</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="c1"># raise NotImplementedError()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># We test your a and b values here</span>

</pre></div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Prove that the analytical “solves” the BVP by:</p></li>
</ol>
<ol class="lowerroman simple">
<li><p>substituting the analytical expression into the partial differential equation and differentiating (in the same way you proved solutions solved the ODE).</p></li>
<li><p>showing that the solution satisfies the boundary conditions. That is, show that <span class="math notranslate nohighlight">\(c(0) = 2000\)</span> and <span class="math notranslate nohighlight">\(c(2) = 93\)</span>.</p></li>
</ol>
<p>Enter work in the cell below</p>
<p>YOUR ANSWER HERE</p>
<ol class="arabic simple" start="3">
<li><p>What would the profile look like if the diffusion coefficient were 10 times larger? Or 10 times smaller? Explain in the cell below</p></li>
</ol>
<p>YOUR ANSWER HERE</p>
<ol class="arabic simple" start="4">
<li><p>If the porosity of the sediments is <span class="math notranslate nohighlight">\(\theta=0.25\)</span>, what is the magnitude of the specific diffusive flux <span class="math notranslate nohighlight">\(j\)</span> in units of <span class="math notranslate nohighlight">\(mg/(s\cdot m^2)\)</span>. Enter the magnitude of the diffusive flux <span class="math notranslate nohighlight">\(j\)</span> in the cell below for autograding.</p></li>
</ol>
<p>Spefically we are expecitng you to write a line in python like:</p>
<p>j=xxx</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># your answer here</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="c1"># raise NotImplementedError()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Hidden test here</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="2-Interpretation">
<h1>2 Interpretation<a class="headerlink" href="#2-Interpretation" title="Permalink to this headline">¶</a></h1>
<p>Heat moves by conduction from high temperature to low temperature according to Fourier’s law: <span class="math">\begin{align}
\vec{q} = -\kappa\nabla u \label{7pde29}\\
\end{align}</span> where * <span class="math notranslate nohighlight">\(u~\left[\Theta\right]\)</span> is the temperature (typical units of Kelvin)(note that <span class="math notranslate nohighlight">\(\Theta\)</span> is the dimension for temperature) * <span class="math notranslate nohighlight">\(q ~\left[{M \over T^3} \right]\)</span> is the specific heat flux (typical units are Watts per <span class="math notranslate nohighlight">\(m^2\)</span>) * <span class="math notranslate nohighlight">\(\kappa~\left[{M L\over T^3\Theta}\right]\)</span> is the thermal conductivity (typical units are Watts per <span class="math notranslate nohighlight">\(m\)</span> per Kelvin) * <span class="math notranslate nohighlight">\(\nabla u~\left[{\Theta\over L}\right]\)</span> is the temperature gradient (typical units are Kelvin
per <span class="math notranslate nohighlight">\(m\)</span>).</p>
<div class="section" id="1.">
<h2>1.<a class="headerlink" href="#1." title="Permalink to this headline">¶</a></h2>
<p>Show that the dimensions of the left and right hand of Fourier’s law are the same:</p>
<p>Dimensions of <span class="math notranslate nohighlight">\(q\)</span>: <span class="math notranslate nohighlight">\(\left[{M \over T^3} \right]\)</span>; Dimensions of <span class="math notranslate nohighlight">\(-\kappa\nabla u\)</span>: <span class="math notranslate nohighlight">\(\left[{\text{Your dimensions here}}\right]\)</span></p>
<p>The partial differential equation that governs heat flow by conduction can be written in vector form <span class="math">\begin{align}
&\rho c_p{\partial u\over \partial t} = \nabla \cdot (\kappa \nabla u)\label{7pde30}\\
\end{align}</span> where <span class="math notranslate nohighlight">\(\rho~\left[{M\over L^3}\right]\)</span> is the density of the material through which heat is conducting. This equation is called <strong>the heat equation</strong>.</p>
</div>
<div class="section" id="2.">
<span id="section-1"></span><h2>2.<a class="headerlink" href="#2." title="Permalink to this headline">¶</a></h2>
<p>What are the dimensions of the specific heat capacity <span class="math notranslate nohighlight">\(c_p\)</span>?</p>
<p><span class="math notranslate nohighlight">\(c_p~\left[{\text{Your dimensions here}}\right]\)</span></p>
</div>
<div class="section" id="3.">
<span id="section-2"></span><h2>3.<a class="headerlink" href="#3." title="Permalink to this headline">¶</a></h2>
<p>What is the physical meaning of the the term <span class="math notranslate nohighlight">\(\rho c_p{\partial u\over \partial t}\)</span> in the heat equation <span class="math">\ref{7pde30}</span>?</p>
</div>
<div class="section" id="4.">
<span id="section-3"></span><h2>4.<a class="headerlink" href="#4." title="Permalink to this headline">¶</a></h2>
<p>Write the transient heat equation in non-vector form in two dimensions (<span class="math notranslate nohighlight">\(x\)</span>, and <span class="math notranslate nohighlight">\(y\)</span>). Hint: look at diffusion equation examples above.</p>
<p><span class="math">\begin{align}
\text{your equation here}
\end{align}</span></p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    <footer class="footer">
  <div class="container">
    <p>
          &copy; Copyright Numeric project.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>